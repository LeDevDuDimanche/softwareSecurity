% Exploits report

\documentclass{article}

\usepackage[utf8]{inputenc}

\title{Exploits}
\author{Simon Le Bail-Collet, Lukas Gelbmann, Bj√∂rn Gudmundsson}
\date{May 2019}

\begin{document}

\maketitle

\section{Buffer overflow (ping)}
The ping command uses sprintf on a small buffer when the host is not known. Since no length checks are performed on the string, the sprintf can overflow 
the buffer and therefore overwrite the return instruction pointer.

\section{Buffer overflow (Command not found)}
When formatting the exception description for when a command is issued that is not specified by the GRASS protocol, no length checks are performed and sprintf
is used in a similar manner as in ping, an easy buffer overflow exploit can be performed. 


\section{Format string (grep)}

Sadly, we were not able to execute this exploit on our own due to time constraints but we can give a detailed explanation of how it will work. 
Since, we are inexperienced developers we forgot that sprintf is an unsafe function to use with user controlled input. We forgot to use safe functions when reading characters
from the ls system command output in grep. Internally, that function uses sprintf, so by naming a file with format identifiers an attacker can insert an arbitrary 
format string of the attackers choosing as long as it conforms to the length specification.

\section{Command injection (grep)}
This exploit takes advantage of how our implementation of the GRASS protocol uses the ls system command to traverse all child directories of the current directory.
The grep command does not escape it filename with apostrophes, allowing for arbitrary command execution. The exploit goes as follows: After a successful login, the user does a mkdir 
and names the directory something with a semi-colon, followed by a shell command. Then the user issues a grep command in the parent directory et voila.

The \texttt{grep} command internally uses \texttt{ls} to find files and directories.
It doesn't

\section{Free choice: command injection (rm)}
This exploit uses a vulnerability in how directories are made and deleted in our GRASS protocol implementation. When escaping character, an implementation decision
was made to pad directory names with apostrophes and if a user were to make a directory with an apostrophe in the directory name, it is removed from the directory name.
The exploit then takes advantage that as carefree developers we remembered to remove apostrophes from the directory name when we are checking if that directory exists but 
use the directory name that has the apostrophe when performing the system command. The exploit then goes as follows: After a successful login, the user creates a directory 
that has a semi-colon, then the user issues then an rm that has a closing apostrophe and allows for arbitrary command execution.

\end{document}
